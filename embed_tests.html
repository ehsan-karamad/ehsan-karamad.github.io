<button onclick="createEmbed();"> Create Embed </button>
<button onclick="attachEmbed();"> Attach Embed </button>
<button onclick="deleteEmbed();"> Delete Embed </button>
<button onclick="navigateEmbed(urlLocal);"> To HTML </button>
<button onclick="navigateEmbed('https://wikipedia.org');"> To Wikipedia </button>
<button onclick="navigateFrame(urlLocal)"> To HTML (use window.frames) </button>
<button onclick="useFlash(urlFlash1);"> Flash 1 </button>
<button onclick="useFlash(urlFlash2);"> Flash 2 </button>

<div style="width: 100%; height: 50%; border: solid red;" id="embed-container"></div>
<div style="width: 100%; height: 50%; border: solid red;" id="updates"></div>

<script>
var embed_ = null;
let urlLocal = "./beforeunload.html";
let urlFlash1 = "./res/flash1.swf";
let urlFlash2 = "./res/flash2.swf";
function createEmbed() {
  embed_ = document.createElement('embed');
  embed_.style = "width: 500px; height: 400px; border: solid purple 2px;";
}

function attachEmbed() {
  if (!embed_ || embed_.parentNode)
    return;
  document.getElementById('embed-container').appendChild(embed_);
}

function deleteEmbed() {
  if (!embed_)
    return;
  if (embed_.parentNode)
    embed_.parentNode.removeChild(embed_);
  embed_ = null;
}

function navigateEmbed(url) {
  if (!embed_)
    return;
  embed_.type = "text/html";
  embed_.src = url;
}

function navigateFrame(url) {
  if (window.frames[0])
    window.frames[0].location.href = url;
}

function useFlash(url) {
  if (!embed_)
    return;
  embed_.type = "application/x-shockwave-flash";
  embed_.src = url;
}

function onMessageFromFlash(msg) {
  console.log(`${(new Date()).toString()}: Received '${msg}`);
  window.setTimeout(() => {
    embed_.onMessageFromWindow('hello');
  }, 1000);
}

window.onmessage = function(e) {
  window.alert('Message Received:' + JSON.stringify(e.data));
};
</script>
