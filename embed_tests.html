<button onclick="createEmbed();"> Create Embed </button>
<button onclick="attachEmbed();"> Attach Embed </button>
<button onclick="deleteEmbed();"> Delete Embed </button>
<button onclick="navigateEmbed(urlLocal);"> To Local HTML </button>
<button onclick="navigateEmbed(urlRemote)"> To Remote HTML </button>
<button onclick="navigateFrame(urlLocal)"> To Local (use window.frames) </button>
<button onclick="navigateFrame(urlRemote)"> To Remote (use window.frames) </button>
<button onclick="useFlash();"> Flash </button>
<div style="width: 100%; height: 50%; border: solid red;" id="embed-container"></div>
<div style="width: 100%; height: 50%; border: solid red;" id="updates"></div>

<script>
var embed_ = null;
let urlLocal = "./beforeunload.html";
let urlRemote = "https://jsfiddle.net/ekaramad/w9rpzuuk/show";

function createEmbed() {
  embed_ = document.createElement('embed');
  embed_.style = "width: 500px; height: 400px; border: solid purple 2px;";
}

function attachEmbed() {
  if (!embed_ || embed_.parentNode)
    return;
  document.getElementById('embed-container').appendChild(embed_);
}

function deleteEmbed() {
  if (!embed_)
    return;
  if (embed_.parentNode)
    embed_.parentNode.removeChild(embed_);
  embed_ = null;
}

function navigateEmbed(url) {
  if (!embed_)
    return;
  embed_.type = "text/html";
  embed_.src = url;
}

function navigateFrame(url) {
  if (window.frames[0])
    window.frames[0].location.href = url;
}

function useFlash() {
  if (!embed_)
    return;
  embed_.type = "application/x-shockwave-flash";
  embed_.src = "./res/flash.swf";
}

function onMessageFromFlash(msg) {
  console.log(`${(new Date()).toString()}: Received '${msg}`);
  window.setTimeout(() => {
    embed_.onMessageFromWindow('hello');
  }, 1000);
}
</script>
